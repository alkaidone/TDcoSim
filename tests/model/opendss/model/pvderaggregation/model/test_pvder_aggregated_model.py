import unittest
import sys
import os

from tdcosim.model.opendss.opendss_data import OpenDSSData
from tdcosim.model.opendss.model.pvderaggregation.model.pvder_aggregated_model import PVDERAggregatedModel

dirlocation = os.path.abspath(sys.modules['__main__'].__file__)
rootindex = dirlocation.index('tdcosim_pkg')
dirlocation = dirlocation[0:rootindex+11]

OpenDSSData.config['myconfig'] = {
    "nodenumber": 11,
    "filePath": [dirlocation+"\\SampleData\\DNetworks\\123Bus\\case123ZIP.dss"],
    "solarFlag":1,
    "solarPenetration":0.1,
    "DERParameters":{
        "power_rating": 50,
        "voltage_rating":174,
        "SteadyState": True,
        "V_LV1": 0.70,
        "V_LV2": 0.88,
        "t_LV1_limit": 10.0,  
        "t_LV2_limit": 20.0,
        "LVRT_INSTANTANEOUS_TRIP": False,
        "LVRT_MOMENTARY_CESSATION": False
    }
}



class TestPVDERAggregatedModel(unittest.TestCase):
    
    def test_init(self):
        model = PVDERAggregatedModel()
        self.assertIsInstance(model, PVDERAggregatedModel)

    def test_setup(self):
        S0 = {'Q': {u's53a': 19.8388671875, u'105_pvder': -0.0, u's73c': 19.8388671875, u's106b': 19.8388671875, u's90b': 19.8388671875, u's86b': 0.0, u's111a': 0.0, u's63a': 19.8388671875, u's104c': 19.8388671875, u's4c': 19.8388671875, u's34c': 19.8388671875, u's43b': 19.8388671875, u's10a': 0.0, u's52a': 19.8388671875, u's17c': 0.0, u's28a': 19.8388671875, u's60a': 0.0, u's5c': 0.0, u's87b': 19.8388671875, u's112a': 0.0, u's96b': 0.0, u's103c': 19.8388671875, u's47': 74.8388671875, u's88a': 19.8388671875, u's20a': 19.8388671875, u's68a': 0.0, u's48': 149.8388671875, u's37a': 19.8388671875, u's9a': 19.8388671875, u's32c': 0.0, u's41c': 0.0, u'150r_pvder': -0.0, u's65a': 24.8388671875, u's65b': 24.8388671875, u's65c': 49.8388671875, u's92c': 19.8388671875, u's71a': 19.8388671875, u's1a': 19.8388671875, u's49b': 49.8388671875, u's49c': 19.8388671875, u's49a': 24.8388671875, u's85c': 19.8388671875, u's99b': 19.8388671875, u's55a': 0.0, u's12b': 0.0, u's79a': 19.8388671875, u's35a': 19.8388671875, u'149_pvder': -0.0, u's70a': 0.0, u's62c': 19.8388671875, u's19a': 19.8388671875, u's7a': 0.0, u's98a': 19.8388671875, u'67_pvder': -0.0, u's42a': 0.0, u's11a': 19.8388671875, u's22b': 19.8388671875, u's109a': 19.8388671875, u's30c': 19.8388671875, u's77b': 19.8388671875, u'72_pvder': -0.0, u's82a': 19.8388671875, u's94a': 19.8388671875, u's38b': 0.0, u's33a': 19.8388671875, u's64b': 34.8388671875, u's16c': 19.8388671875, u's76a': 79.8388671875, u's76b': 49.8388671875, u's76c': 49.8388671875, u's83c': 0.0, u's100c': 19.8388671875, u's84c': 0.0, u's107b': 19.8388671875, u's56b': 0.0, u's24c': 19.8388671875, u'49_pvder': -0.0, u's6c': 19.8388671875, u's29a': 19.8388671875, u's59b': 0.0, u's75c': 19.8388671875, u's113a': 19.8388671875, u's80b': 19.8388671875, u's2b': 0.0, u's114a': 0.0, u's45a': 0.0, u's69a': 19.8388671875, u's51a': 0.0, u'62_pvder': -0.0, u's31c': 0.0, u's58b': 0.0, u's66c': 34.8388671875, u's102c': 0.0, u's95b': 0.0, u's74c': 19.8388671875, u'300_pvder': -0.0, u's39b': 0.0, u's46a': 0.0, u's50c': 19.8388671875}, 'P': {u's53a': 40.0, u'105_pvder': -46.0, u's73c': 40.0, u's106b': 40.0, u's90b': 40.0, u's86b': 20.0, u's111a': 20.0, u's63a': 40.0, u's104c': 40.0, u's4c': 40.0, u's34c': 40.0, u's43b': 40.0, u's10a': 20.0, u's52a': 40.0, u's17c': 20.0, u's28a': 40.0, u's60a': 20.0, u's5c': 20.0, u's87b': 40.0, u's112a': 20.0, u's96b': 20.0, u's103c': 40.0, u's47': 105.0, u's88a': 40.0, u's20a': 40.0, u's68a': 20.0, u's48': 210.0, u's37a': 40.0, u's9a': 40.0, u's32c': 20.0, u's41c': 20.0, u'150r_pvder': -46.0, u's65a': 35.0, u's65b': 35.0, u's65c': 70.0, u's92c': 40.0, u's71a': 40.0, u's1a': 40.0, u's49b': 70.0, u's49c': 35.0, u's49a': 35.0, u's85c': 40.0, u's99b': 40.0, u's55a': 20.0, u's12b': 20.0, u's79a': 40.0, u's35a': 40.0, u'149_pvder': -46.0, u's70a': 20.0, u's62c': 40.0, u's19a': 40.0, u's7a': 20.0, u's98a': 40.0, u'67_pvder': -46.0, u's42a': 20.0, u's11a': 40.0, u's22b': 40.0, u's109a': 40.0, u's30c': 40.0, u's77b': 40.0, u'72_pvder': -46.0, u's82a': 40.0, u's94a': 40.0, u's38b': 20.0, u's33a': 40.0, u's64b': 75.0, u's16c': 40.0, u's76a': 105.0, u's76b': 70.0, u's76c': 70.0, u's83c': 20.0, u's100c': 40.0, u's84c': 20.0, u's107b': 40.0, u's56b': 20.0, u's24c': 40.0, u'49_pvder': -46.0, u's6c': 40.0, u's29a': 40.0, u's59b': 20.0, u's75c': 40.0, u's113a': 40.0, u's80b': 40.0, u's2b': 20.0, u's114a': 20.0, u's45a': 20.0, u's69a': 40.0, u's51a': 20.0, u'62_pvder': -46.0, u's31c': 20.0, u's58b': 20.0, u's66c': 75.0, u's102c': 20.0, u's95b': 20.0, u's74c': 40.0, u'300_pvder': -46.0, u's39b': 20.0, u's46a': 20.0, u's50c': 40.0}}
        V0 = {u'160r': {'a': (2251.8199326181543-135.4236030204727j), 'c': (-1071.2588622050223+2019.4851895888044j), 'b': (-1234.369849018638-1986.2911241990153j)}, u'150r_tfr': {'a': (172.86009253340902+0.8105222323305649j), 'c': (-87.1331377002301+149.2959034247256j), 'b': (-85.72690594673097-150.10815581179915j)}, u'91': {'a': (2239.9850999256646-154.0888105575707j), 'c': (-1060.296347492667+2027.573136417878j), 'b': (-1255.7200574436517-1962.4302970039903j)}, u'135': {'a': (2273.690883953401-93.25719126378638j), 'c': (-1111.073076368625+2014.7985474622776j), 'b': (-1215.3121641980547-2010.0660803751477j)}, u'24': {'c': (-1104.336726322134+2009.22715428285j)}, u'25': {'a': (2269.376597900246-99.24276089973215j), 'c': (-1106.0937141670759+2010.3414995299374j), 'b': (-1215.5370102055163-2011.9703016587664j)}, u'26': {'a': (2268.68575183971-100.08737572212596j), 'c': (-1105.203944755972+2010.1381057373692j)}, u'27': {'a': (2267.786074361781-100.79154682776333j), 'c': (-1105.5167395873252+2009.8820308033507j)}, u'20': {'a': (2268.3842337747765-94.84167500872887j)}, u'21': {'a': (2272.2387451718437-95.18330243159049j), 'c': (-1108.9259115787722+2013.3066267832j), 'b': (-1215.3780822935169-2010.0340706481975j)}, u'22': {'b': (-1214.637890396509-2006.6031043269784j)}, u'23': {'a': (2271.1113845010977-97.17886448144434j), 'c': (-1107.0687151750644+2011.7037003962091j), 'b': (-1215.2723956491914-2011.0196990339457j)}, u'160': {'a': (2251.8238799118926-135.36407279452612j), 'c': (-1071.2988109883693+2019.460685031318j), 'b': (-1234.3317020480338-1986.3113195635121j)}, u'28': {'a': (2268.437798189702-100.31971524437691j), 'c': (-1105.8549644907448+2009.5338730978722j), 'b': (-1215.7468982478063-2012.4851142344341j)}, u'29': {'a': (2268.003401399709-101.1988532802328j), 'c': (-1105.0934453606617+2008.709443579257j), 'b': (-1215.6966281102104-2012.944048506718j)}, u'4': {'c': (-1158.0838785133706+2039.9275778850094j)}, u'8': {'a': (2310.987700942245-59.03226746779744j), 'c': (-1137.8126288564172+2033.0017457367167j), 'b': (-1205.5821755775773-2030.9888058105755j)}, u'59': {'b': (-1228.2184161625573-2000.2683657604175j)}, u'58': {'b': (-1228.039308480622-2000.9952394729385j)}, u'55': {'a': (2271.6861655732478-100.84636496662905j), 'c': (-1101.8941814264913+2024.344766491158j), 'b': (-1224.1863865760263-2010.8415528426356j)}, u'54': {'a': (2272.057760957649-100.55623776708114j), 'c': (-1101.6981360245704+2024.355189481851j), 'b': (-1223.8247580283678-2011.0360813188786j)}, u'57': {'a': (2265.4327578124858-111.38067834890138j), 'c': (-1092.286883760203+2023.0964917365477j), 'b': (-1227.680910877417-2002.4489220714258j)}, u'56': {'a': (2271.5351145735913-100.67492215985291j), 'c': (-1102.0157841705102+2024.499304487144j), 'b': (-1224.470194366526-2010.4310988928746j)}, u'51': {'a': (2257.629849744887-102.93898596353233j), 'c': (-1095.408872495715+2007.868527674684j), 'b': (-1213.5705115071003-1992.1028118122708j)}, u'50': {'a': (2257.8323221796286-102.52441022453417j), 'c': (-1095.3409656772988+2008.0185213615687j), 'b': (-1213.500076916814-1991.937431472901j)}, u'53': {'a': (2275.24240683913-96.76836968166019j), 'c': (-1105.425073732351+2024.7473893223548j), 'b': (-1221.9014744109218-2013.3061971763452j)}, u'52': {'a': (2280.990548771181-90.19443367420023j), 'c': (-1111.1612614980843+2025.5615637603091j), 'b': (-1218.555825942437-2016.6799987434758j)}, u'300_open': {'a': (2257.629880668119-102.93902831319811j), 'c': (-1095.4088683286222+2007.8685633505986j), 'b': (-1213.5705397801048-1992.1028585603804j)}, u'197': {'a': (2245.611604113002-147.15751560441882j), 'c': (-1063.203838462066+2016.6592462515493j), 'b': (-1239.034509063096-1980.3138806366906j)}, u'114': {'a': (2219.3735447444847-162.88629246767962j)}, u'88': {'a': (2241.4084288910144-155.45769841752625j)}, u'89': {'a': (2240.5847264351432-154.09050999576462j), 'c': (-1060.5757275624564+2026.9858526352514j), 'b': (-1255.2902466141907-1963.1731771515256j)}, u'111': {'a': (2224.7965157992453-160.7238947630722j)}, u'110': {'a': (2226.0995665643118-159.58060739582757j)}, u'113': {'a': (2220.111071744395-162.24072143390882j)}, u'112': {'a': (2224.7191746347394-160.29295914781878j)}, u'82': {'a': (2256.618075647863-160.02005087725206j), 'c': (-1052.3464747978742+2034.40820104247j), 'b': (-1258.982927679361-1979.158522643659j)}, u'83': {'a': (2259.0595565838644-160.95222702946887j), 'c': (-1051.713050996205+2036.9839780969946j), 'b': (-1261.3269813097231-1980.6263076867767j)}, u'80': {'a': (2253.4296992996606-157.31680896144712j), 'c': (-1053.8101027860916+2030.8231468972162j), 'b': (-1254.8933189740867-1976.201205987002j)}, u'81': {'a': (2255.011062069679-158.46895279403475j), 'c': (-1052.6351027193107+2032.146039956043j), 'b': (-1256.348461176468-1977.4652986049623j)}, u'86': {'a': (2243.497826468568-153.1267142294258j), 'c': (-1060.3217046907153+2024.8819293791155j), 'b': (-1250.6951268391072-1967.844182586024j)}, u'87': {'a': (2241.73650355518-154.23639294612246j), 'c': (-1060.456719573529+2026.1214263192026j), 'b': (-1253.6037416439467-1964.5183222885612j)}, u'84': {'c': (-1047.4243764994537+2028.4141673285646j)}, u'85': {'c': (-1045.1203886681874+2026.212241047888j)}, u'3': {'c': (-1159.0867966933997+2040.8118907171065j)}, u'7': {'a': (2324.005881047889-46.449621598989864j), 'c': (-1147.6448712473914+2037.0156656273493j), 'b': (-1200.9595129253423-2035.9890044256301j)}, u'300': {'a': (2239.4232507272354-152.1869136305497j), 'c': (-1066.1171790655742+2014.2482202255803j), 'b': (-1240.3168053879526-1981.2538171899268j)}, u'149_tfr': {'a': (172.86005344326674+0.8105361104322728j), 'c': (-87.13313063550932+149.29587129842582j), 'b': (-85.72688685700408-150.10813785782864j)}, u'108': {'a': (2239.00613114731-153.03249443263059j), 'c': (-1065.3260342087399+2014.3135441522106j), 'b': (-1240.7275274564822-1980.4238315433515j)}, u'109': {'a': (2230.0922919873983-157.2743882574406j)}, u'102': {'c': (-1059.4982240208046+2013.507020386322j)}, u'103': {'c': (-1056.321617633493+2010.5147888818246j)}, u'100': {'a': (2246.197786301013-147.23080086952154j), 'c': (-1059.699877840044+2016.101909611176j), 'b': (-1237.8468967238407-1977.7623517668817j)}, u'101': {'a': (2244.321404345248-148.69814166715972j), 'c': (-1062.3447715957354+2015.7746491808223j), 'b': (-1238.8332018500987-1979.7969498192608j)}, u'106': {'b': (-1239.1408871579983-1976.0558772320758j)}, u'107': {'b': (-1238.2683018449093-1972.3086910796053j)}, u'104': {'c': (-1052.9012905941124+2007.290756996979j)}, u'105': {'a': (2241.873004903258-150.12879788095708j), 'c': (-1063.965234407141+2015.6316168878177j), 'b': (-1239.8229103755793-1978.988361705881j)}, u'39': {'b': (-1217.9886604086212-1999.9185154417228j)}, u'38': {'b': (-1217.7523035853696-2000.8628578588662j)}, u'94_open': {'a': (2272.057760957649-100.55623776708114j)}, u'33': {'a': (2264.5659908904013-101.74174247372045j)}, u'32': {'c': (-1103.0370648354813+2009.5233711335502j)}, u'31': {'c': (-1103.9038036606923+2009.76934724709j)}, u'30': {'a': (2268.6330670352622-101.3659283898364j), 'c': (-1103.7341883643328+2008.1989350249294j), 'b': (-1215.21186353027-2013.1141270203434j)}, u'37': {'a': (2263.4563052588087-98.49181151499718j)}, u'36': {'a': (2265.3877119123463-97.91893967822499j), 'b': (-1217.388447186891-2002.3156082786516j)}, u'35': {'a': (2268.024219521148-96.93284993650495j), 'c': (-1107.662661964164+2013.6984854897885j), 'b': (-1215.2718296141968-2003.6594471363935j)}, u'34': {'c': (-1120.2565102121407+2026.0970065487238j)}, u'62_tfr': {'a': (164.1443998789982-8.980796482232686j), 'c': (-78.68080527896977+146.57125741964256j), 'b': (-89.12949379601021-145.16295282103326j)}, u'67_tfr': {'a': (163.97478651378506-9.736229190827139j), 'c': (-78.39450668924998+146.76849930781165j), 'b': (-89.67850094928234-144.95280236114434j)}, u'450': {'a': (2246.1978915690647-147.23086227231045j), 'c': (-1059.6998722768099+2016.1020283807054j), 'b': (-1237.8470072705127-1977.7624297376806j)}, u'60': {'a': (2251.8240862834696-135.364086271221j), 'c': (-1071.2988960704017+2019.4608234263933j), 'b': (-1234.3317719217976-1986.311451867663j)}, u'61': {'a': (2251.8241378034954-135.36411597474176j), 'c': (-1071.298901063645+2019.460882430666j), 'b': (-1234.3318215977577-1986.3114789799602j)}, u'62': {'a': (2250.3396442043395-134.9040019514784j), 'c': (-1068.7672975907722+2015.5419217340277j), 'b': (-1232.0333300267698-1984.8839356644105j)}, u'63': {'a': (2248.9090085142348-134.3764598533548j), 'c': (-1067.2853603787523+2013.5952267886114j), 'b': (-1230.574509544833-1983.3304420332731j)}, u'64': {'a': (2248.152211111906-133.44906542906145j), 'c': (-1063.6575444890927+2009.6298797313004j), 'b': (-1226.9243413089644-1980.2453075837525j)}, u'65': {'a': (2246.447977670176-133.76151608523185j), 'c': (-1060.0377744913856+2003.374433869794j), 'b': (-1224.961764839538-1980.5069177687155j)}, u'66': {'a': (2246.9626331065037-134.78833510467783j), 'c': (-1058.2651683247154+2000.213576807023j), 'b': (-1224.3126978990158-1981.5849914281541j)}, u'67': {'a': (2247.4146768710707-145.2343625814744j), 'c': (-1064.576659719868+2017.740214178868j), 'b': (-1239.2399000504658-1981.4990601667625j)}, u'68': {'a': (2243.9180007896944-146.73972777149024j)}, u'69': {'a': (2239.728796171543-148.25924409770923j)}, u'250': {'a': (2268.6330732428373-101.36593253109776j), 'c': (-1103.7341892650127+2008.1989431857667j), 'b': (-1215.2118702586065-2013.1141313885134j)}, u'9r': {'a': (2307.6225716607-60.41291379273166j)}, u'72_tfr': {'a': (163.98438621696545-10.013266656543616j), 'c': (-78.08245231745148+146.9062586136267j), 'b': (-89.89193128758194-144.6704953843273j)}, u'2': {'b': (-1194.0828716223662-2042.7469073424456j)}, u'6': {'c': (-1155.2646199039164+2038.0146203251388j)}, u'105_tfr': {'a': (163.57347578416505-10.091410215448407j), 'c': (-78.35068382879457+146.61445743437784j), 'b': (-89.72094789218033-144.77079036669548j)}, u'99': {'a': (2245.7433292308715-147.0733372069195j), 'c': (-1060.8260977999569+2016.5717283883362j), 'b': (-1238.3841550634424-1977.6089527951165j)}, u'98': {'a': (2245.0475010015816-147.5783168470266j), 'c': (-1062.6387071410686+2016.4432680632378j), 'b': (-1239.0300323728127-1979.5787986009266j)}, u'25r': {'a': (2269.3739780633505-99.24748669042488j), 'c': (-1106.0894754105873+2010.3438223112676j)}, u'90': {'b': (-1256.661012619232-1961.9469521313767j)}, u'93': {'a': (2239.0622468363017-154.40770295994818j), 'c': (-1060.7999132611048+2027.5477142613934j), 'b': (-1256.4428648991316-1961.94742085291j)}, u'92': {'c': (-1058.2100492804568+2028.228203449684j)}, u'95': {'a': (2238.833114306708-154.0875633068841j), 'c': (-1061.0577061103154+2027.891325459287j), 'b': (-1257.058139576332-1961.0321309667056j)}, u'94': {'a': (2237.2763104259284-154.88798166315857j)}, u'97': {'a': (2245.6116480241844-147.1575356251965j), 'c': (-1063.203836894281+2016.6592792659371j), 'b': (-1239.0345339736023-1980.313889004082j)}, u'96': {'b': (-1257.1901496776798-1960.4474007177325j)}, u'11': {'a': (2302.3880154772087-62.65294454491j)}, u'10': {'a': (2303.4447886958255-62.67016865781906j)}, u'13': {'a': (2293.7890202439316-76.01636319012704j), 'c': (-1122.1811593861594+2027.5646449276148j), 'b': (-1211.329564063736-2022.9095667100642j)}, u'12': {'b': (-1205.7528996012622-2030.337513967321j)}, u'15': {'c': (-1119.4706433862264+2025.5670604799896j)}, u'14': {'a': (2303.9860079651726-62.150524201493916j)}, u'17': {'c': (-1118.4599109265544+2025.2830269507665j)}, u'16': {'c': (-1117.6066001111321+2023.8839786062852j)}, u'19': {'a': (2270.4749202736903-94.21768657475236j)}, u'18': {'a': (2273.6909946886317-93.25724555020196j), 'c': (-1111.0730711781678+2014.7986381074134j), 'b': (-1215.3122785969902-2010.066134740648j)}, u'150r': {'a': (2370.2236026807764-0.07122561036292654j), 'c': (-1185.0660741645445+2052.7086005681795j), 'b': (-1185.1569516773448-2052.6611969612004j)}, u'49_tfr': {'a': (164.70625704670897-6.583947062004375j), 'c': (-80.69574393988218+146.08704476298595j), 'b': (-87.82279261509113-145.68650831060606j)}, u'151': {'a': (2257.629880668119-102.93902831319811j), 'c': (-1095.4088683286222+2007.8685633505986j), 'b': (-1213.5705397801048-1992.1028585603804j)}, u'150': {'a': (2370.2302857763443-0.05296017788854042j), 'c': (-1185.0811295851254+2052.7054475365j), 'b': (-1185.1486821096955-2052.6701829327408j)}, u'152': {'a': (2293.788736821285-76.01630129980089j), 'c': (-1122.1810737949406+2027.5644315885256j), 'b': (-1211.3294390452681-2022.90939274343j)}, u'61s': {'a': (2251.8241378034954-135.36411597472866j), 'c': (-1071.2989010636568+2019.4608824306595j), 'b': (-1234.331821597746-1986.311478979967j)}, u'300_tfr': {'a': (163.39603885254218-10.240721459537552j), 'c': (-78.50727881536456+146.512709606167j), 'b': (-89.75732039681343-144.93511969298407j)}, u'48': {'a': (2257.3320109214146-102.13464908207087j), 'c': (-1096.778856082237+2008.4850582709446j), 'b': (-1214.3398047033588-1992.0816251854826j)}, u'49': {'a': (2257.6887911095328-101.98721962324592j), 'c': (-1096.2430342139935+2008.536356982495j), 'b': (-1213.8790877071226-1991.6512500209956j)}, u'46': {'a': (2258.6903139354545-102.56722756653885j)}, u'47': {'a': (2258.0269497242275-101.8254126891882j), 'c': (-1097.395821534742+2008.7616874214689j), 'b': (-1214.4527690557957-1992.7907546078718j)}, u'44': {'a': (2260.235710383042-101.13623912752584j), 'c': (-1100.1556925479879+2009.9777653481156j), 'b': (-1214.8403063367082-1995.5089571298315j)}, u'45': {'a': (2259.3526880056515-101.9539980205007j)}, u'42': {'a': (2262.3243302276646-99.91328121245351j), 'c': (-1102.255030942316+2011.1906930443104j), 'b': (-1215.036821118425-1997.3693078901726j)}, u'43': {'b': (-1214.322802719734-1994.1018267468128j)}, u'40': {'a': (2265.255846096104-98.4130438217377j), 'c': (-1104.7296501954843+2012.4659625293325j), 'b': (-1215.0656187505858-2000.5014469089244j)}, u'41': {'c': (-1103.7909005275126+2012.1992760854241j)}, u'1': {'a': (2343.760752077658-27.067855648204162j), 'c': (-1162.3166545183094+2043.2179141965134j), 'b': (-1193.9466181614168-2043.2524250087633j)}, u'5': {'c': (-1156.517747056626+2039.1209809526183j)}, u'9': {'a': (2307.6251703774765-60.4057383999016j)}, u'610': {'a': (261.89534323051-11.687599378503984j), 'c': (-121.54192806098187+236.94605040615994j), 'b': (-140.3534167646151-225.25844872250883j)}, u'149': {'a': (2370.2230666079345-0.07103784623127492j), 'c': (-1185.0659754678184+2052.70816095364j), 'b': (-1185.1566912610285-2052.660949849251j)}, u'77': {'a': (2248.705637686956-154.1132113820849j), 'c': (-1057.3617489956919+2025.6998356939077j), 'b': (-1249.676882773604-1974.2937057069823j)}, u'76': {'a': (2246.618480358638-151.6417658793042j), 'c': (-1059.2571243923935+2021.9235875434276j), 'b': (-1245.440075803652-1974.293272673804j)}, u'75': {'c': (-1050.8923410843029+2010.7327440082342j)}, u'74': {'c': (-1052.8438032378356+2012.5777563273268j)}, u'73': {'c': (-1056.259232158301+2015.8055796963201j)}, u'72': {'a': (2247.5274184698997-149.02955765372448j), 'c': (-1060.2851931628952+2019.6081968137714j), 'b': (-1242.160108355264-1977.6022690993593j)}, u'71': {'a': (2235.101341873354-149.96525923730167j)}, u'70': {'a': (2236.8865466211896-149.4811066712827j)}, u'79': {'a': (2248.501264040042-155.43412476055778j), 'c': (-1057.167858637925+2026.2040016900978j), 'b': (-1250.9411157452205-1974.9036114687362j)}, u'78': {'a': (2249.251700871414-154.87547401995647j), 'c': (-1056.857880230794+2026.4869684516716j), 'b': (-1250.6799772514528-1974.7001524642017j)}}
        model = PVDERAggregatedModel()        
        pvdermap = model.setup(S0, V0)
        for node in S0:
            self.assertIsNotNone(S0[node])        
    
    # def test_run(self):
    #     V = {u'160r': {'a': (2370.2542224946305-0.002555808101133009j), 'c': (-1185.1247733195557+2052.700811850259j), 'b': (-1185.1275036374916-2052.698135897305j)}, u'150r_tfr': {'a': (172.7027796828413+2.3069971144665763e-07j), 'c': (-86.35139000457411+149.5649944085661j), 'b': (-86.35138964574229-149.5649945931886j)}, u'91': {'a': (2370.255012669264-0.0028191321107580197j), 'c': (-1185.1247535961609+2052.701577262264j), 'b': (-1185.1281583762732-2052.698522184298j)}, u'135': {'a': (2370.252414919286-0.0017245521793864062j), 'c': (-1185.124606088218+2052.6992737065057j), 'b': (-1185.1263681203031-2052.697490129537j)}, u'24': {'c': (-1185.1245841894565+2052.699494635377j)}, u'25': {'a': (2370.2525924409692-0.0017385804494827145j), 'c': (-1185.1245778832483+2052.6995539925456j), 'b': (-1185.1264455147075-2052.697528792498j)}, u'26': {'a': (2370.252625432637-0.0017347362738993316j), 'c': (-1185.1245714361166+2052.6996023944816j)}, u'27': {'a': (2370.252641892019-0.001739727974264717j), 'c': (-1185.1245661380785+2052.69960598581j)}, u'20': {'a': (2370.252442230342-0.0017514899833019184j)}, u'21': {'a': (2370.2524829307386-0.0017324453598586613j), 'c': (-1185.1245983450506+2052.699386389002j), 'b': (-1185.1264094297303-2052.6975124444616j)}, u'22': {'b': (-1185.126427493127-2052.6975174168115j)}, u'23': {'a': (2370.252537389825-0.0017340309970766805j), 'c': (-1185.1245891400074+2052.6994756425265j), 'b': (-1185.1264297123876-2052.697520374854j)}, u'160': {'a': (2370.254220327832-0.00255580592102422j), 'c': (-1185.124772324065+2052.7008101219703j), 'b': (-1185.1275027824158-2052.698134419559j)}, u'28': {'a': (2370.252607851336-0.0017449674371897142j), 'c': (-1185.124576996077+2052.699573783971j), 'b': (-1185.1264605112285-2052.6975403954416j)}, u'29': {'a': (2370.2526243625002-0.0017518106102984204j), 'c': (-1185.1245760454858+2052.699594989074j), 'b': (-1185.1264765789017-2052.697552827157j)}, u'4': {'c': (-1185.1245746350987+2052.6969545851507j)}, u'8': {'a': (2370.251193059345-0.0011450624094206073j), 'c': (-1185.1246457516831+2052.698013811568j), 'b': (-1185.1256286347284-2052.69685240149j)}, u'59': {'b': (-1185.1268903692207-2052.6978092341587j)}, u'58': {'b': (-1185.1268817675452-2052.697806866282j)}, u'55': {'a': (2370.2528418556312-0.0020609547268385232j), 'c': (-1185.1247483027262+2052.6996481588985j), 'b': (-1185.1265284359267-2052.6976264037053j)}, u'54': {'a': (2370.2528320167226-0.0020546705267002383j), 'c': (-1185.1247467999517+2052.699637086925j), 'b': (-1185.1265206358667-2052.6976204210537j)}, u'57': {'a': (2370.253273877835-0.0022211877930006377j), 'c': (-1185.1247626104089+2052.700009546902j), 'b': (-1185.126855962537-2052.69779976258j)}, u'56': {'a': (2370.2528451352637-0.0020630494335652214j), 'c': (-1185.124748803657+2052.699651849572j), 'b': (-1185.1265310359634-2052.6976283978884j)}, u'51': {'a': (2370.252845504599-0.00198669567785005j), 'c': (-1185.1246585531132+2052.699621938903j), 'b': (-1185.1266854650285-2052.6977350149514j)}, u'50': {'a': (2370.252830020168-0.0019787033294112184j), 'c': (-1185.124655164913+2052.699606562502j), 'b': (-1185.1266708455978-2052.697727474403j)}, u'53': {'a': (2370.2526658393044-0.0019614192757993858j), 'c': (-1185.1247375671114+2052.6994779193997j), 'b': (-1185.1264319241945-2052.697541663284j)}, u'52': {'a': (2370.2523951851026-0.0018091703514036925j), 'c': (-1185.1247220659359+2052.6992178831483j), 'b': (-1185.1262862036626-2052.6974127501376j)}, u'300_open': {'a': (2370.2528640871205-0.001996283776732865j), 'c': (-1185.124662619+2052.699640391432j), 'b': (-1185.1267030079523-2052.697744062923j)}, u'197': {'a': (2370.2546849927985-0.002690475531306596j), 'c': (-1185.1247094768694+2052.7012115095213j), 'b': (-1185.1277658786291-2052.6983147193j)}, u'114': {'a': (2370.255182344094-0.0030518514766118047j)}, u'88': {'a': (2370.254971858715-0.002805455483753058j)}, u'89': {'a': (2370.254993757278-0.002813142544048739j), 'c': (-1185.1247545778187+2052.7015565579213j), 'b': (-1185.128139897053-2052.698510326808j)}, u'111': {'a': (2370.2551328026457-0.0030029819530080788j)}, u'110': {'a': (2370.255118194234-0.0029885716592515563j)}, u'113': {'a': (2370.2551740871663-0.0030437065278849703j)}, u'112': {'a': (2370.25513407294-0.0030042349688040415j)}, u'82': {'a': (2370.254886673542-0.0027027985655663444j), 'c': (-1185.1247484464484+2052.701622396709j), 'b': (-1185.128043501799-2052.6983969597377j)}, u'83': {'a': (2370.2548896757216-0.0027037493634325333j), 'c': (-1185.124748290576+2052.701625683379j), 'b': (-1185.1280464352253-2052.698398842042j)}, u'80': {'a': (2370.254868688412-0.0027033824019941214j), 'c': (-1185.1247478754738+2052.701585974929j), 'b': (-1185.1280234461735-2052.698390609755j)}, u'81': {'a': (2370.254877667618-0.0026999462558575547j), 'c': (-1185.1247489139168+2052.70161253728j), 'b': (-1185.1280347019404-2052.698391313106j)}, u'86': {'a': (2370.254895203938-0.0027701262994255754j), 'c': (-1185.1247581876146+2052.701469468352j), 'b': (-1185.1280338260683-2052.6984329136926j)}, u'87': {'a': (2370.254967412661-0.002801069654295766j), 'c': (-1185.1247525051035+2052.701527007476j), 'b': (-1185.1281011911776-2052.698484521282j)}, u'84': {'c': (-1185.124730687314+2052.701682466116j)}, u'85': {'c': (-1185.1247264118276+2052.7016988690443j)}, u'3': {'c': (-1185.1245764352939+2052.696947678665j)}, u'7': {'a': (2370.2507244955254-0.0008898522316999125j), 'c': (-1185.1246247627628+2052.697566406416j), 'b': (-1185.1253939500423-2052.6966418910165j)}, u'300': {'a': (2370.254934648326-0.0028012798826085104j), 'c': (-1185.1246541008018+2052.7012556714017j), 'b': (-1185.1277921145183-2052.698388771236j)}, u'149_tfr': {'a': (172.70277968284137+2.293657871797609e-07j), 'c': (-86.35139000345653+149.5649944092112j), 'b': (-86.35138964673416-149.56499459261593j)}, u'108': {'a': (2370.254923838494-0.0027968529945096017j), 'c': (-1185.1246527614067+2052.701245482227j), 'b': (-1185.12778128207-2052.698383148089j)}, u'109': {'a': (2370.2550495980336-0.002920906249582371j)}, u'102': {'c': (-1185.1246886724846+2052.7012868331844j)}, u'103': {'c': (-1185.1246798966488+2052.701320502497j)}, u'100': {'a': (2370.254754866241-0.0027190889107735704j), 'c': (-1185.1247181350132+2052.701277370539j), 'b': (-1185.127835897467-2052.698351066578j)}, u'101': {'a': (2370.2547580540763-0.002717437420339303j), 'c': (-1185.124698798365+2052.701247983858j), 'b': (-1185.1277861310102-2052.698333156846j)}, u'106': {'b': (-1185.1278211244396-2052.6983721886895j)}, u'107': {'b': (-1185.1278409081738-2052.698377634593j)}, u'104': {'c': (-1185.1246735959342+2052.7013446752308j)}, u'105': {'a': (2370.25483386025-0.002758142584155828j), 'c': (-1185.1246824646869+2052.7012461099853j), 'b': (-1185.1277979000229-2052.698365795526j)}, u'39': {'b': (-1185.1265697591455-2052.6976353739387j)}, u'38': {'b': (-1185.1265585769686-2052.697632295698j)}, u'94_open': {'a': (2370.2528320167226-0.0020546706262508574j)}, u'33': {'a': (2370.252654594763-0.001752258638886131j)}, u'32': {'c': (-1185.1245626604036+2052.699636064015j)}, u'31': {'c': (-1185.1245653606427+2052.6996257041637j)}, u'30': {'a': (2370.252635920406-0.0017566007862047765j), 'c': (-1185.1245753799913+2052.6996098326526j), 'b': (-1185.1264878262289-2052.6975615293422j)}, u'37': {'a': (2370.2525788249995-0.001851242156904869j)}, u'36': {'a': (2370.2525712033535-0.0018437237582652989j), 'b': (-1185.126532771964-2052.697625191994j)}, u'35': {'a': (2370.252551508461-0.0018111770890605569j), 'c': (-1185.1246293701938+2052.6993575291217j), 'b': (-1185.1264897997858-2052.697577166535j)}, u'34': {'c': (-1185.1246801642415+2052.6987233286395j)}, u'62_tfr': {'a': (172.7031565838637-0.000189301313610517j), 'c': (-86.35140563897261+149.56535461412395j), 'b': (-86.3516093540961-149.56515658508175j)}, u'67_tfr': {'a': (172.70318091085673-0.000192775612229237j), 'c': (-86.35140322712465+149.5653757629125j), 'b': (-86.35162096585621-149.56516733818685j)}, u'450': {'a': (2370.254764892915-0.0027231951615432274j), 'c': (-1185.1247193773056+2052.70128682156j), 'b': (-1185.1278459451885-2052.698356282277j)}, u'60': {'a': (2370.2542203278326-0.0025557983103924216j), 'c': (-1185.124772330139+2052.700810118464j), 'b': (-1185.1275027772044-2052.6981344225683j)}, u'61': {'a': (2370.254237748037-0.002567009053224461j), 'c': (-1185.1247733228545+2052.700832048913j), 'b': (-1185.127517434012-2052.6981477695967j)}, u'62': {'a': (2370.254240453008-0.0026004260077878557j), 'c': (-1185.1247486075501+2052.700849342076j), 'b': (-1185.1275485909807-2052.6981291328757j)}, u'63': {'a': (2370.254251580094-0.002625100489221027j), 'c': (-1185.1247354914117+2052.7008710287037j), 'b': (-1185.127573921247-2052.6981262081513j)}, u'64': {'a': (2370.254267476071-0.002660349747424907j), 'c': (-1185.1247167539411+2052.7009020094965j), 'b': (-1185.1276101072006-2052.6981220298985j)}, u'65': {'a': (2370.254279057335-0.0026860314828822834j), 'c': (-1185.1247031022888+2052.7009245809013j), 'b': (-1185.1276364713387-2052.6981189860167j)}, u'66': {'a': (2370.2542820095036-0.002692577877892614j), 'c': (-1185.124699622346+2052.700930334234j), 'b': (-1185.1276431915794-2052.6981182102095j)}, u'67': {'a': (2370.2545743273827-0.002648108813489643j), 'c': (-1185.1247155062856+2052.7011395973714j), 'b': (-1185.1277079558947-2052.69827671323j)}, u'68': {'a': (2370.254609895637-0.0026831946045180674j)}, u'69': {'a': (2370.2546448286676-0.00271765387017124j)}, u'250': {'a': (2370.2526381219004-0.0017575131973395954j), 'c': (-1185.1245752532564+2052.699612660011j), 'b': (-1185.1264899685864-2052.6975631868986j)}, u'9r': {'a': (2370.251233245961-0.0011845339730341374j)}, u'72_tfr': {'a': (172.66168372473066-0.0001947611506447188j), 'c': (-86.33065205173969+149.52944241314324j), 'b': (-86.33087697125525-149.52922555690307j)}, u'2': {'b': (-1185.1250422714309-2052.696323431768j)}, u'6': {'c': (-1185.1245654093243+2052.69698998116j)}, u'105_tfr': {'a': (172.70319982112576-0.0002007929713542186j), 'c': (-86.35140081962409+149.56538352371064j), 'b': (-86.3516275194295-149.5651738289647j)}, u'99': {'a': (2370.2547435861884-0.002714469363514049j), 'c': (-1185.1247167375468+2052.701266738187j), 'b': (-1185.127824593835-2052.6983451989017j)}, u'98': {'a': (2370.2547091194288-0.002700354178214848j), 'c': (-1185.1247124673475+2052.701234250287j), 'b': (-1185.1277900548582-2052.698327270135j)}, u'25r': {'a': (2370.2525926132794-0.001738580622391329j), 'c': (-1185.1245779979222+2052.6995541916276j)}, u'90': {'b': (-1185.128148498855-2052.69851269464j)}, u'93': {'a': (2370.255027159846-0.002827758551339826j), 'c': (-1185.124751876817+2052.7015823697193j), 'b': (-1185.128170939701-2052.6985344367113j)}, u'92': {'c': (-1185.1247508957986+2052.7015876222217j)}, u'95': {'a': (2370.255027081174-0.00283180200276448j), 'c': (-1185.1247556337935+2052.7015830571227j), 'b': (-1185.1281850054293-2052.698544519581j)}, u'94': {'a': (2370.255034146358-0.0028346504269234443j)}, u'97': {'a': (2370.2546849927985-0.002690473468129826j), 'c': (-1185.124709478139+2052.7012115087887j), 'b': (-1185.127765877532-2052.6983147199335j)}, u'96': {'b': (-1185.1281918867742-2052.6985464138816j)}, u'11': {'a': (2370.251293584971-0.0012440543353428356j)}, u'10': {'a': (2370.251293585079-0.0012440543382566027j)}, u'13': {'a': (2370.2518443360336-0.0014985678900986212j), 'c': (-1185.1246896149573+2052.698687069238j), 'b': (-1185.1259871907685-2052.6971491271056j)}, u'12': {'b': (-1185.1256363762313-2052.69685453258j)}, u'15': {'c': (-1185.1246756639132+2052.698740595038j)}, u'14': {'a': (2370.2512872336015-0.0012377890080742006j)}, u'17': {'c': (-1185.1246725136373+2052.698752681528j)}, u'16': {'c': (-1185.1246722885405+2052.698753544706j)}, u'19': {'a': (2370.252433973559-0.0017433450524703307j)}, u'18': {'a': (2370.2524149192855-0.0017245491070191983j), 'c': (-1185.1246060903613+2052.6992737052683j), 'b': (-1185.1263681176424-2052.6974901310728j)}, u'150r': {'a': (2370.2490676972598+7.948851747145637e-07j), 'c': (-1185.1245340341793+2052.695905722238j), 'b': (-1185.1245332166936-2052.695905884739j)}, u'49_tfr': {'a': (172.70305223640645-0.00014318552961904645j), 'c': (-86.35139848487785+149.5652624933494j), 'b': (-86.35154390787571-149.5651265499376j)}, u'151': {'a': (2370.2528640871205-0.0019962836771822445j), 'c': (-1185.1246626190862+2052.699640391382j), 'b': (-1185.1267030078661-2052.6977440629726j)}, u'150': {'a': (2370.24906706065+8.012326919842513e-07j), 'c': (-1185.1245337315959+2052.695905185714j), 'b': (-1185.1245329384196-2052.6959054137515j)}, u'152': {'a': (2370.2518443360336-0.0014985786589546085j), 'c': (-1185.1246896063203+2052.6986870742235j), 'b': (-1185.1259871988873-2052.697149122417j)}, u'61s': {'a': (2370.254237748037-0.002567009139078683j), 'c': (-1185.1247733227801+2052.700832048956j), 'b': (-1185.127517434086-2052.698147769553j)}, u'300_tfr': {'a': (172.66170194800412-0.00020388706065797228j), 'c': (-86.33064619377325+149.52943964354398j), 'b': (-86.33087448382332-149.52923097636028j)}, u'48': {'a': (2370.252782755651-0.0019543032618185353j), 'c': (-1185.1246448228353+2052.699559627326j), 'b': (-1185.1266262195104-2052.6977044562555j)}, u'49': {'a': (2370.252808342514-0.001967512661043695j), 'c': (-1185.124650421602+2052.699585035963j), 'b': (-1185.126650378206-2052.6977169173206j)}, u'46': {'a': (2370.252765412555-0.0019514084821332862j)}, u'47': {'a': (2370.2527808977607-0.0019533437360252487j), 'c': (-1185.1246444163346+2052.6995577823j), 'b': (-1185.126624465119-2052.6977035513687j)}, u'44': {'a': (2370.2527425471867-0.0019288533146810203j), 'c': (-1185.1246385591048+2052.6995146261534j), 'b': (-1185.1265940636174-2052.69768023405j)}, u'45': {'a': (2370.2527577907795-0.0019438900790805385j)}, u'42': {'a': (2370.252690836432-0.0018993118514751234j), 'c': (-1185.1246389503112+2052.69947704834j), 'b': (-1185.1265735279287-2052.6976563264557j)}, u'43': {'b': (-1185.1265907311652-2052.6976610620263j)}, u'40': {'a': (2370.252623873425-0.0018552158071283528j), 'c': (-1185.1246352419425+2052.699426079347j), 'b': (-1185.126534380858-2052.697616457887j)}, u'41': {'c': (-1185.1246323166838+2052.6994373025186j)}, u'1': {'a': (2370.250014494228-0.0005024666169163795j), 'c': (-1185.1245921864581+2052.696887246366j), 'b': (-1185.1250362502637-2052.696321774253j)}, u'5': {'c': (-1185.1245676595686+2052.696981348053j)}, u'9': {'a': (2370.2512330736504-0.0011845337999215777j)}, u'610': {'a': (273.4907956599725-0.00029876364383868366j), 'c': (-136.7452413621612+236.85008955125772j), 'b': (-136.74555598505648-236.84978844061578j)}, u'149': {'a': (2370.24906769726+7.765778756981761e-07j), 'c': (-1185.1245340188414+2052.695905731092j), 'b': (-1185.1245332303065-2052.6959058768794j)}, u'77': {'a': (2370.2548205734993-0.0027087781669530545j), 'c': (-1185.124745429467+2052.7014783229074j), 'b': (-1185.1279682770414-2052.6983766296244j)}, u'76': {'a': (2370.2547616252755-0.002704462962680345j), 'c': (-1185.1247450502358+2052.70137554304j), 'b': (-1185.1279050044964-2052.698350930701j)}, u'75': {'c': (-1185.12470909+2052.701391246397j)}, u'74': {'c': (-1185.1247126904082+2052.701377433407j)}, u'73': {'c': (-1185.124722141308+2052.7013411741464j)}, u'72': {'a': (2370.2546844839685-0.002676001763341156j), 'c': (-1185.1247345174413+2052.7012936917404j), 'b': (-1185.1278262613368-2052.698314374337j)}, u'71': {'a': (2370.2546765858883-0.0027489805108189113j)}, u'70': {'a': (2370.254669599377-0.0027420886366576517j)}, u'79': {'a': (2370.2548356106763-0.0027099521132556417j), 'c': (-1185.1247455087205+2052.7015043464685j), 'b': (-1185.1279843885172-2052.6983832426317j)}, u'78': {'a': (2370.2548329090278-0.002709096403222334j), 'c': (-1185.1247456489239+2052.701501388743j), 'b': (-1185.1279817486104-2052.6983815486738j)}}

    #     S0 = {'Q': {u's53a': 21.416015625, u's73c': 21.416015625, u's106b': 21.416015625, u's90b': 21.416015625, u's86b': 0.0, u's111a': 0.0, u's63a': 21.416015625, u's104c': 21.416015625, u's4c': 21.416015625, u's34c': 21.416015625, u's43b': 21.416015625, u's10a': 0.0, u's52a': 21.416015625, u's17c': 0.0, u's28a': 21.416015625, u's60a': 0.0, u's5c': 0.0, u's87b': 21.416015625, u's112a': 0.0, u's96b': 0.0, u's103c': 21.416015625, u's47': 76.416015625, u's88a': 21.416015625, u's20a': 21.416015625, u's68a': 0.0, u's48': 151.416015625, u's37a': 21.416015625, u's9a': 21.416015625, u's32c': 0.0, u's41c': 0.0, u's65a': 26.416015625, u's65b': 26.416015625, u's65c': 51.416015625, u's92c': 21.416015625, u's71a': 21.416015625, u's1a': 21.416015625, u's49b': 51.416015625, u's49c': 21.416015625, u's49a': 26.416015625, u's85c': 21.416015625, u's99b': 21.416015625, u's55a': 0.0, u's12b': 0.0, u's79a': 21.416015625, u's35a': 21.416015625, u's70a': 0.0, u's62c': 21.416015625, u's19a': 21.416015625, u's7a': 0.0, u's98a': 21.416015625, u's42a': 0.0, u's11a': 21.416015625, u's22b': 21.416015625, u's109a': 21.416015625, u's30c': 21.416015625, u's77b': 21.416015625, u's82a': 21.416015625, u's94a': 21.416015625, u's38b': 0.0, u's33a': 21.416015625, u's64b': 36.416015625, u's16c': 21.416015625, u's76a': 81.416015625, u's76b': 51.416015625, u's76c': 51.416015625, u's83c': 0.0, u's100c': 21.416015625, u's84c': 0.0, u's107b': 21.416015625, u's56b': 0.0, u's24c': 21.416015625, u's6c': 21.416015625, u's29a': 21.416015625, u's59b': 0.0, u's75c': 21.416015625, u's113a': 21.416015625, u's80b': 21.416015625, u's2b': 0.0, u's114a': 0.0, u's45a': 0.0, u's69a': 21.416015625, u's51a': 0.0, u's31c': 0.0, u's58b': 0.0, u's66c': 36.416015625, u's102c': 0.0, u's95b': 0.0, u's74c': 21.416015625, u's39b': 0.0, u's46a': 0.0, u's50c': 21.416015625}, 'P': {u's53a': 40.0, u's73c': 40.0, u's106b': 40.0, u's90b': 40.0, u's86b': 20.0, u's111a': 20.0, u's63a': 40.0, u's104c': 40.0, u's4c': 40.0, u's34c': 40.0, u's43b': 40.0, u's10a': 20.0, u's52a': 40.0, u's17c': 20.0, u's28a': 40.0, u's60a': 20.0, u's5c': 20.0, u's87b': 40.0, u's112a': 20.0, u's96b': 20.0, u's103c': 40.0, u's47': 105.0, u's88a': 40.0, u's20a': 40.0, u's68a': 20.0, u's48': 210.0, u's37a': 40.0, u's9a': 40.0, u's32c': 20.0, u's41c': 20.0, u's65a': 35.0, u's65b': 35.0, u's65c': 70.0, u's92c': 40.0, u's71a': 40.0, u's1a': 40.0, u's49b': 70.0, u's49c': 35.0, u's49a': 35.0, u's85c': 40.0, u's99b': 40.0, u's55a': 20.0, u's12b': 20.0, u's79a': 40.0, u's35a': 40.0, u's70a': 20.0, u's62c': 40.0, u's19a': 40.0, u's7a': 20.0, u's98a': 40.0, u's42a': 20.0, u's11a': 40.0, u's22b': 40.0, u's109a': 40.0, u's30c': 40.0, u's77b': 40.0, u's82a': 40.0, u's94a': 40.0, u's38b': 20.0, u's33a': 40.0, u's64b': 75.0, u's16c': 40.0, u's76a': 105.0, u's76b': 70.0, u's76c': 70.0, u's83c': 20.0, u's100c': 40.0, u's84c': 20.0, u's107b': 40.0, u's56b': 20.0, u's24c': 40.0, u's6c': 40.0, u's29a': 40.0, u's59b': 20.0, u's75c': 40.0, u's113a': 40.0, u's80b': 40.0, u's2b': 20.0, u's114a': 20.0, u's45a': 20.0, u's69a': 40.0, u's51a': 20.0, u's31c': 20.0, u's58b': 20.0, u's66c': 75.0, u's102c': 20.0, u's95b': 20.0, u's74c': 40.0, u's39b': 20.0, u's46a': 20.0, u's50c': 40.0}}
    #     V0 = {u'160r': {'a': (2237.390351547694-145.8565669057777j), 'c': (-1057.619553242159+2015.8767511523129j), 'b': (-1239.6905281551674-1973.2639490407653j)}, u'91': {'a': (2224.01488121963-165.40934059326244j), 'c': (-1045.2656088579122+2023.2200394345857j), 'b': (-1261.0671426797442-1947.5104779794774j)}, u'135': {'a': (2265.2376124369284-97.71670507503666j), 'c': (-1104.4294252268437+2012.442241107808j), 'b': (-1218.429324410273-2003.9666831963164j)}, u'24': {'c': (-1097.8119265127525+2006.6164444888607j)}, u'25': {'a': (2260.621044619631-103.61439555673951j), 'c': (-1099.5790100141614+2007.83819556158j), 'b': (-1218.7432236968239-2005.8619118100912j)}, u'26': {'a': (2259.8814762113607-104.43573391579167j), 'c': (-1098.706046521787+2007.6404710698998j)}, u'27': {'a': (2258.943478997493-105.12093418383279j), 'c': (-1099.0325443846366+2007.3908092973902j)}, u'20': {'a': (2259.7917660387475-99.14761173160943j)}, u'21': {'a': (2263.686003689072-99.61080120460689j), 'c': (-1102.3193075502884+2010.8875906442222j), 'b': (-1218.5025945867221-2003.9204408501064j)}, u'22': {'b': (-1217.6335657670454-2000.460538046198j)}, u'23': {'a': (2262.463721104839-101.588681285469j), 'c': (-1100.504186378627+2009.224385079059j), 'b': (-1218.4350600573969-2004.9156799673142j)}, u'160': {'a': (2237.397290702135-145.78931419735338j), 'c': (-1057.6673699700495+2015.8504898532237j), 'b': (-1239.6469571642804-1973.289789692322j)}, u'28': {'a': (2259.630614304473-104.67694888662771j), 'c': (-1099.3638112374335+2007.0096420122918j), 'b': (-1218.9739419874034-2006.3778859480333j)}, u'29': {'a': (2259.1593932186775-105.5554910524636j), 'c': (-1098.6180191411174+2006.1464469413604j), 'b': (-1218.9384300647723-2006.8458353877302j)}, u'4': {'c': (-1156.1010641396524+2039.0536205848534j)}, u'8': {'a': (2305.329232328882-62.11646714005886j), 'c': (-1133.2514239213863+2031.5348849965956j), 'b': (-1207.7190249155817-2027.00410143175j)}, u'59': {'b': (-1232.6985075424823-1990.6805999162132j)}, u'58': {'b': (-1232.5220930262758-1991.4083537791823j)}, u'55': {'a': (2261.0453853979884-107.24932780780817j), 'c': (-1092.5725203539998+2021.7359703327134j), 'b': (-1228.2917799031334-2002.8620941808663j)}, u'54': {'a': (2261.417995901943-106.96011061173985j), 'c': (-1092.3764040455128+2021.7458405402456j), 'b': (-1227.930721993507-2003.0577391876898j)}, u'57': {'a': (2253.5889964369817-119.06330451734489j), 'c': (-1081.592829063771+2020.1697699304284j), 'b': (-1232.1690811414796-1992.8637969196075j)}, u'56': {'a': (2260.894859788524-107.07735467661476j), 'c': (-1092.693646240364+2021.8909388414995j), 'b': (-1228.574312455943-2002.4506243337646j)}, u'51': {'a': (2248.1094401541377-108.55912368881988j), 'c': (-1087.324237711358+2005.2192646243332j), 'b': (-1217.0357677311858-1984.8561098878865j)}, u'50': {'a': (2248.313145782175-108.14485097780715j), 'c': (-1087.2558878628408+2005.3691632762802j), 'b': (-1216.9648473264103-1984.690822746734j)}, u'53': {'a': (2265.1293045636776-102.7703192523799j), 'c': (-1096.6655774350156+2022.2587117383282j), 'b': (-1225.7941998692781-2005.783681963553j)}, u'52': {'a': (2271.748418420275-95.56753356289383j), 'c': (-1103.2912165643897+2023.261147354466j), 'b': (-1222.0940947508202-2009.8918900314457j)}, u'300_open': {'a': (2248.1094707700863-108.55916597837792j), 'c': (-1087.324233504587+2005.2193001952596j), 'b': (-1217.0357961509335-1984.856156433592j)}, u'197': {'a': (2230.0343184491044-158.9593333548756j), 'c': (-1048.029366290086+2012.5602904874718j), 'b': (-1244.9254787977068-1965.5750543356849j)}, u'114': {'a': (2202.6306566696862-175.2508156101434j)}, u'88': {'a': (2225.444326455499-166.7542029433923j)}, u'89': {'a': (2224.6417864969562-165.41253130122794j), 'c': (-1045.5362660846624+2022.665667635284j), 'b': (-1260.6321360488078-1948.2466019226304j)}, u'111': {'a': (2208.173977687662-173.23635898793998j)}, u'110': {'a': (2209.4854753216596-172.09992000891148j)}, u'113': {'a': (2203.3729460011814-174.6090785749688j)}, u'112': {'a': (2208.0797489743964-172.78204253534517j)}, u'82': {'a': (2240.590544530423-171.46496315265276j), 'c': (-1037.3364063761856+2029.9676949315112j), 'b': (-1264.5059727560542-1964.2791081892763j)}, u'83': {'a': (2243.0068126568426-172.4030482241908j), 'c': (-1036.6962749221634+2032.528540739589j), 'b': (-1266.851924815532-1965.7277100888548j)}, u'80': {'a': (2237.5057876795936-168.7736927469972j), 'c': (-1038.7825413354744+2026.4249775456226j), 'b': (-1260.391685927722-1961.3547216544935j)}, u'81': {'a': (2239.0456130800267-169.92892741721172j), 'c': (-1037.6143449837482+2027.7127546628587j), 'b': (-1261.8564023605643-1962.6121996005531j)}, u'86': {'a': (2227.666851513633-164.53285537259856j), 'c': (-1045.2787572794246+2020.6054502665356j), 'b': (-1256.1594749087947-1953.0292938174387j)}, u'87': {'a': (2225.813055480864-165.57197275433637j), 'c': (-1045.4214155265488+2021.8283266398746j), 'b': (-1258.9790250988228-1949.6152103422887j)}, u'84': {'c': (-1032.4669155609818+2023.800328280585j)}, u'85': {'c': (-1030.2062572712127+2021.478326466607j)}, u'3': {'c': (-1157.0913110075805+2039.9841759718588j)}, u'7': {'a': (2319.5930667179377-48.85382737476894j), 'c': (-1144.097349022421+2035.850874348441j), 'b': (-1202.6267524725538-2032.896832416382j)}, u'300': {'a': (2222.633355248665-165.84029974593784j), 'c': (-1049.1097961977218+2010.3233692973029j), 'b': (-1247.1280330422662-1964.436134015873j)}, u'108': {'a': (2222.6331935588896-165.84020318670593j), 'c': (-1049.1098050787875+2010.323184680292j), 'b': (-1247.127859715393-1964.4360135793775j)}, u'109': {'a': (2213.543411358248-169.86982421074816j)}, u'102': {'c': (-1043.9700920282335+2009.2772675509414j)}, u'103': {'c': (-1040.8523242803365+2006.1193441869293j)}, u'100': {'a': (2230.6271066945246-159.0550842956998j), 'c': (-1044.4888457655006+2011.8649527970695j), 'b': (-1243.623473996609-1963.0262455847392j)}, u'101': {'a': (2228.4820267031896-160.89376034049585j), 'c': (-1046.775308673011+2011.6631028732809j), 'b': (-1244.8818796728112-1964.6214070095164j)}, u'106': {'b': (-1245.24792492392-1960.3364939737485j)}, u'107': {'b': (-1244.2206739595465-1956.56197749879j)}, u'104': {'c': (-1037.4953232729176+2002.7169261191277j)}, u'105': {'a': (2225.742215754534-162.72117193294926j), 'c': (-1047.9634517214135+2011.5989733576332j), 'b': (-1246.05102633178-1963.2903667221603j)}, u'39': {'b': (-1221.156963897001-1993.4687087308073j)}, u'38': {'b': (-1220.9230109039818-1994.4138436370838j)}, u'94_open': {'a': (2261.417995901943-106.96011061173985j)}, u'33': {'a': (2255.639232372891-105.97783353076866j)}, u'32': {'c': (-1096.5397119113165+2007.021291122738j)}, u'31': {'c': (-1097.4062325369623+2007.2690455865088j)}, u'30': {'a': (2259.793485745426-105.7463974300653j), 'c': (-1097.2542449645205+2005.5820987022937j), 'b': (-1218.4516492176226-2007.0349244780953j)}, u'37': {'a': (2254.5734287292926-103.10445667882337j)}, u'36': {'a': (2256.5554961388384-102.58781649209412j), 'b': (-1220.562852158627-1995.8678134762722j)}, u'35': {'a': (2259.281236487493-101.64826043230197j), 'c': (-1100.6909742078074+2011.3103216238833j), 'b': (-1218.4185226172137-1997.2308355390282j)}, u'34': {'c': (-1114.166813715625+2024.0914255869775j)}, u'450': {'a': (2230.627210869206-159.055145903059j), 'c': (-1044.4888396775648+2011.865070965542j), 'b': (-1243.623584569186-1963.026322630661j)}, u'60': {'a': (2237.397523853597-145.7893380183812j), 'c': (-1057.6674611689934+2015.8506555159586j), 'b': (-1239.6470465882853-1973.2899408180772j)}, u'61': {'a': (2237.39757489536-145.7893678006507j), 'c': (-1057.6674658949457+2015.8507142950314j), 'b': (-1239.6470962415024-1973.2899676020966j)}, u'62': {'a': (2235.5208527044165-145.40182545546742j), 'c': (-1054.9339821863086+2011.6250238916095j), 'b': (-1237.236820473318-1971.5599232070833j)}, u'63': {'a': (2234.073730562742-144.8186312533814j), 'c': (-1053.4867766587724+2009.6301682418114j), 'b': (-1235.7216318183753-1970.019616006955j)}, u'64': {'a': (2233.313878407989-143.85951548902335j), 'c': (-1049.9201256585332+2005.5428767344936j), 'b': (-1231.9474858182616-1966.9881576405005j)}, u'65': {'a': (2231.5674075527445-144.12811458891414j), 'c': (-1046.413164053082+1999.1446985797165j), 'b': (-1229.9440497987027-1967.2937514983037j)}, u'66': {'a': (2232.0641244449216-145.17495612981398j), 'c': (-1044.6941773257997+1995.9180829655375j), 'b': (-1229.3128833366725-1968.3952280468557j)}, u'67': {'a': (2232.122378018235-156.65541662270394j), 'c': (-1049.7982066461143+2013.6758610384852j), 'b': (-1244.9980558437494-1967.2076266471718j)}, u'68': {'a': (2228.551353484297-158.07161265587953j)}, u'69': {'a': (2224.2635385281483-159.47141642533705j)}, u'250': {'a': (2259.7934919172085-105.7464015691028j), 'c': (-1097.254245850107+2005.5821068452667j), 'b': (-1218.451655949477-2007.03492882291j)}, u'9r': {'a': (2301.8872727977005-63.41611519170718j)}, u'2': {'b': (-1195.0450635514105-2040.993441238582j)}, u'6': {'c': (-1153.3056294580663+2037.053492253963j)}, u'99': {'a': (2230.1710915348413-158.87834385519253j), 'c': (-1045.6159939857348+2012.3838433918331j), 'b': (-1244.1637849432805-1962.8505812272447j)}, u'98': {'a': (2229.445059613045-159.36579895858694j), 'c': (-1047.4631143277156+2012.3201254884577j), 'b': (-1244.8936356492748-1964.8282502656482j)}, u'25r': {'a': (2260.618222906179-103.619109371803j), 'c': (-1099.5747653978651+2007.840510724169j)}, u'90': {'b': (-1261.9309773786247-1946.9978201418173j)}, u'93': {'a': (2223.059975581612-165.7084106874523j), 'c': (-1045.7835646464832+2023.2026821458066j), 'b': (-1261.7983719252532-1947.0183803969685j)}, u'92': {'c': (-1043.199373457957+2023.786357934967j)}, u'95': {'a': (2222.832465044562-165.38687155655208j), 'c': (-1046.0396223219211+2023.5478595415277j), 'b': (-1262.408989284171-1946.0993053028592j)}, u'94': {'a': (2221.226594846507-166.13001148357267j)}, u'97': {'a': (2230.034375804454-158.9593559228817j), 'c': (-1048.0293696612441+2012.5603360181008j), 'b': (-1244.9255118571734-1965.575072967941j)}, u'96': {'b': (-1262.5378953336456-1945.513571432728j)}, u'11': {'a': (2296.5375178707377-65.53449499597049j)}, u'10': {'a': (2297.6355380531845-65.59586285046967j)}, u'13': {'a': (2286.3451640695826-80.1596885403394j), 'c': (-1116.0698924732249+2025.6313490088078j), 'b': (-1214.1325637040006-2017.60023314664j)}, u'12': {'b': (-1207.8886986332802-2026.3524584947932j)}, u'15': {'c': (-1113.3881740501154+2023.537108768891j)}, u'14': {'a': (2298.1776281333964-65.07677810443114j)}, u'17': {'c': (-1112.3777175743262+2023.2511011062425j)}, u'16': {'c': (-1111.5509370673842+2021.7647519993914j)}, u'19': {'a': (2261.9372865992327-98.58411614467863j)}, u'18': {'a': (2265.2377299693676-97.71676205044817j), 'c': (-1104.429421482579+2012.4423384813492j), 'b': (-1218.429444072978-2003.9667416260477j)}, u'150r': {'a': (2370.2206363522705-0.07831878966238906j), 'c': (-1185.0587947232282+2052.710122860616j), 'b': (-1185.1621028448742-2052.6562553694166j)}, u'151': {'a': (2248.1094707700863-108.55916597837792j), 'c': (-1087.324233504587+2005.2193001952596j), 'b': (-1217.0357961509335-1984.856156433592j)}, u'150': {'a': (2370.2280957126277-0.058235191685900994j), 'c': (-1185.0757247754937+2052.706592314298j), 'b': (-1185.1525182237783-2052.666521785278j)}, u'152': {'a': (2286.344847361798-80.15961293843796j), 'c': (-1116.0697997292764+2025.631101498761j), 'b': (-1214.1324143561176-2017.6000357194546j)}, u'61s': {'a': (2237.397574895361-145.78936780063768j), 'c': (-1057.6674658949576+2015.8507142950252j), 'b': (-1239.6470962414908-1973.2899676021034j)}, u'48': {'a': (2247.946072807123-107.52839984792551j), 'c': (-1088.9100148734433+2005.8905206247218j), 'b': (-1217.7308552046834-1985.0009467360824j)}, u'49': {'a': (2248.169518289205-107.59415349972541j), 'c': (-1088.1604135095483+2005.9260061335956j), 'b': (-1217.3464176725151-1984.3874095415288j)}, u'46': {'a': (2249.477750059116-107.77595708770495j)}, u'47': {'a': (2248.6461589074156-107.22307518481533j), 'c': (-1089.527401885862+2006.1728990175034j), 'b': (-1217.849843135235-1985.7118118407816j)}, u'44': {'a': (2251.0275914196386-106.34802274411386j), 'c': (-1092.5176217579094+2007.4464096257539j), 'b': (-1218.1555879157438-1988.5901288638067j)}, u'45': {'a': (2250.1420293865635-107.16403668165435j)}, u'42': {'a': (2253.2562073894383-104.97678684765347j), 'c': (-1094.8005785079429+2008.7051475603325j), 'b': (-1218.2858200170992-1990.5786778357929j)}, u'43': {'b': (-1217.4482275596654-1987.28402581748j)}, u'40': {'a': (2256.3503417410034-103.30268227087006j), 'c': (-1097.5164587335205+2010.0285987546556j), 'b': (-1218.263407226598-1993.8920216055621j)}, u'41': {'c': (-1096.5780092640978+2009.7597141328238j)}, u'1': {'a': (2341.2170173441345-28.45219811816733j), 'c': (-1160.2894438176086+2042.5061866699377j), 'b': (-1194.909170320654-2041.499081750057j)}, u'5': {'c': (-1154.5429130404223+2038.217627051741j)}, u'9': {'a': (2301.8900723426455-63.408946549664535j)}, u'610': {'a': (260.4657553172261-12.851516562838556j), 'c': (-119.73405469038997+236.5684890388174j), 'b': (-140.73170220683866-223.71697017264043j)}, u'149': {'a': (2370.220053992342-0.07810909457532045j), 'c': (-1185.0586878365298+2052.709634779952j), 'b': (-1185.1618090222764-2052.65597550866j)}, u'77': {'a': (2232.904347615369-165.5867326855084j), 'c': (-1042.3356448176814+2021.393172642004j), 'b': (-1255.2201950521335-1959.5210419090215j)}, u'76': {'a': (2230.9314085311876-163.1673555867736j), 'c': (-1044.2304020532422+2017.65592111068j), 'b': (-1251.0539682627125-1959.6157117453745j)}, u'75': {'c': (-1036.0500486417197+2006.0134287154178j)}, u'74': {'c': (-1037.9656368415588+2007.959806574344j)}, u'73': {'c': (-1041.3182641071203+2011.365049086961j)}, u'72': {'a': (2231.9606325990394-160.63101440309862j), 'c': (-1045.270169551297+2015.3768192825557j), 'b': (-1247.8785029274372-1963.0167353704417j)}, u'71': {'a': (2219.528205201068-161.04659629398532j)}, u'70': {'a': (2221.3609026953172-160.6208647191843j)}, u'79': {'a': (2232.633198168211-166.87902046212113j), 'c': (-1042.1629416294284+2021.890875901642j), 'b': (-1256.4928894390778-1960.109359516045j)}, u'78': {'a': (2233.416879494087-166.33919145797955j), 'c': (-1041.8372804701223+2022.1669294008755j), 'b': (-1256.2198444273224-1959.9123004749579j)}}
        
    #     model = PVDERAggregatedModel()          
    #     pvdermap = model.setup(S0, V0)  
    #     print('OpenDSSData')      
    #     print(OpenDSSData.data['DNet']['DER'])      
    #     P, Q = model.run(V)
        



if __name__ == '__main__':
    unittest.main()
